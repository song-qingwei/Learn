[TOC]

#### MongoDB 中的应用场景及设计原理

---

MongoDB 是一个基于分布式文件存储的数据库。由 C++语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。 MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。

##### 什么是 NoSQL

NoSQL，指的是非关系型的数据库。NoSQL 有时也称作 Not Only SQL 的缩写，是对不同于传统的关系型数据库的数据库管理系统的统称。NoSQL 用于超大规模数据的存储。（例如谷歌或 Facebook 每天为他们的用户收集万亿比特的数据）。这些类型的数据存储不需要固定的模式，无需多余操作就可以横向扩展。

##### 关系型数据库和非关系型数据库比较

| 关系型数据库                 | NoSQL 数据库                              |
| ---------------------------- | ----------------------------------------- |
| 高度组织化结构化数据         | 代表着不仅仅是 SQL                        |
| 结构化查询语言（SQL）        | 没有声明性查询语言                        |
| 数据和关系都存储在单独的表中 | 没有预定义的模式                          |
| 数据操作语言，数据定义语言   | 键-值对存储，列存储，文档存储，图形数据库 |
| 严格的一致性                 | 最终一致性，而非 ACID 属性                |
| 基础事务                     | 非结构化和不可预知的数据                  |
|                              | CAP 定理                                  |
|                              | 高性能，高可用性和可伸缩性                |

##### NoSQL 数据库分类

| 类型           | 典型代表                                                 | 特点                                                         |
| -------------- | -------------------------------------------------------- | ------------------------------------------------------------ |
| 列存储         | Hbase、Cassandra、Hypertable                             | 顾名思义，是按照列存储数据的。最大的特点是方便存储结构化和半结构化的数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的 IO 优势 |
| 文档存储       | MongoDB、CounchDB                                        | 文档存储一般用类似 json 的格式存储，存储的内容是文档型的。这样也就有机会对某些字段建立索引，实现关系数据库的某些功能。 |
| Key-value 存储 | 存储 Tokyo Cabinet/Tyrant、Berkelery DB、Memcache、Redis | 可 以 通 过 key 快 速 查 询 到 其value 。 一 般来 说 ， 存储 不 管value 的格式，照单全收。(Redis包含了其他功能) |
| 图存储         | Neo4J、FlockDB                                           | 图形关系的最佳存储。使用传统关系数据库来解决的话性能低下，而且设计使用不方便。 |
| 对象存储       | Db4o、Versant                                            | 通过类似面向对象语言的语法操作数据库，通过对象的方式存储数据。 |
| XML 数据库     | Berkeley DB XML、BaseX                                   | 高效的存储 XML 数据，并存储 XML的 内 部 查 询 语 法 ， 比 如XQuery，Xpath。 |

##### MongoDB 的数据结构与关系型数据库数据结构对比

| 关系型数据库术语/概念 | MongoDB 术语/概念 | 解释/说明                         |
| --------------------- | ----------------- | --------------------------------- |
| Database              | Database          | 数据库                            |
| Table                 | Collection        | 数据库表/集合                     |
| Row                   | Document          | 数据记录行/文档                   |
| Column                | Field             | 数据列/数据字段                   |
| Index                 | Index             | 索引                              |
| Table joins           |                   | 表关联/MongoDB 不支持             |
| Primary Key           | Object ID         | 主键/MongoDB 自动将_id 设置为主键 |

##### MongoDB 中的数据类型

| 数据类型     | 说明       | 解释                                                         | 举例                 |
| ------------ | ---------- | ------------------------------------------------------------ | -------------------- |
| Null         | 空值       | 表示空值或者未定义的对象                                     | {“x”:null}           |
| Boolean      | 布尔值     | 真或者假：true 或者 false                                    | {“x”:true}           |
| Integer      | 整数       | 整型数值。用于存储数值。根据你所采用的服务器，可分为 32 位或 64位。 |                      |
| Double       | 浮点数     | 双精度浮点值。                                               | {“x”：3.14，”y”：3}  |
| String       | 字符串     | UTF-8 字符串                                                 |                      |
| Symbol       | 符号       | 符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。 |                      |
| ObjectID     | 对象 ID    | 对象 ID。用于创建文档的 ID。                                 | {“id”: ObjectId()}   |
| Date         | 日期       | 日期时间。用 UNIX 时间格式来存储当前日期或时间。             | {“date”:new Date()}  |
| Timestamp    | 时间戳     | 从标准纪元开始的毫秒数                                       |                      |
| Regular      | 正则表达式 | 文档中可以包含正则表达式，遵循 JavaScript的语法              | {“foo”:/testdb/i}    |
| Code         | 代码       | 可 以 包 含 JavaScript代码                                   | {“x”：function() {}} |
| Undefined    | 未定义     | 已废弃                                                       |                      |
| Array        | 数组       | 值得集合或者列表                                             | {“arr”: [“a”,”b”]}   |
| Binary Data  | 二进制     | 用于存储二进制数据                                           |                      |
| Object       | 内嵌文档   | 文档可以作为文档中某个 key 的 value                          | {“x”:{“foo”:”bar”}}  |
| Min/Max keys | 最小/大值  | 将一个值与 BSON（二进制的 JSON）元素的最低值和最高值相对比。 |                      |

##### MongoDB 底层原理

